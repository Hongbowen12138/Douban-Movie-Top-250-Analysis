### 项目概述

该项目的主要目的是从豆瓣电影网站爬取 Top 250 电影的数据，并对这些数据进行分析和可视化。项目分为以下几个部分：

1. **数据爬取 (`douban_movie_crawler.py`)**
    - **原理**：使用 `requests` 库发送 HTTP 请求获取豆瓣电影 Top 250 的网页内容，并使用 `lxml` 库解析 HTML，提取电影的相关信息，如标题、链接、评分、年份和类型、参演人员等。
    - **反爬虫技术**：
        - **模拟用户请求**：通过设置 `User-Agent` 请求头来模拟浏览器请求，避免直接被网站屏蔽。
        - **随机延时**：在每次请求之间添加一个随机延时，模拟人类用户的访问行为，避免被网站检测到异常请求频率。
        - **异常处理**：使用 `try-except` 块捕获请求和解析过程中可能出现的异常，确保脚本在遇到错误时不会崩溃，并记录错误信息。

2. **数据处理与清洗**
    - **原理**：读取爬取到的数据，并对年份和类型信息进行拆分和清洗，使数据更加结构化。
    - **操作**：
        - 读取 Excel 文件并拆分年份和类型列。
        - 删除原始的“年份和类型”列，保留清洗后的数据。

3. **数据可视化**
    - **散点图 (`douban_visual_scatter_plot.py`)**：
        - **原理**：使用 `plotly.express` 库创建交互式散点图，展示评分和年份的关系，并添加电影标题作为标签。
        - **步骤**：读取处理后的数据，添加随机扰动（jitter）模拟散点图的抖动效果，创建交互式散点图并保存为 HTML 文件。
    - **柱状图 (`Visual_bar_chart.py`)**：
        - **原理**：使用 `plotly.graph_objects` 库创建柱状图，展示不同年份的电影数量分布。
        - **步骤**：读取处理后的数据，按年份分组统计电影数量，创建柱状图并保存为 HTML 文件。
    - **饼状图 (`Visual_pie_chart.py`)**：
        - **原理**：使用 `plotly.graph_objects` 库创建饼状图，展示不同评分的电影数量分布。
        - **步骤**：读取处理后的数据，按评分分组统计电影数量，创建饼状图并保存为 HTML 文件。

### 反反爬虫技术详细说明

1. **模拟用户请求**：
    - 通过设置 `User-Agent` 请求头来模拟浏览器请求，从而避免网站识别为爬虫。例如：
      ```python
      HEADERS = {
          "User-Agent": (
              "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 "
              "(KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Edg/123.0.0.0"
          )
      }
      ```

2. **随机延时**：
    - 在每次请求之间添加一个随机延时，模拟人类用户的访问行为，避免被网站检测到异常请求频率。例如：
      ```python
      import time
      import random

      time.sleep(random.uniform(1, 5))
      ```

3. **异常处理**：
    - 使用 `try-except` 块捕获请求和解析过程中可能出现的异常，确保脚本在遇到错误时不会崩溃，并记录错误信息。例如：
      ```python
      try:
          response = requests.get(url, headers=HEADERS)
          response.raise_for_status()
      except requests.RequestException as e:
          print(f"请求失败：{e}")
      ```

### 执行命令

在命令行中执行该主脚本：

```bash
python main.py
```

这将依次运行各个子脚本，完成数据爬取、数据处理和可视化的全过程。每个脚本运行时会打印输出信息到控制台，方便查看执行状态和调试信息。